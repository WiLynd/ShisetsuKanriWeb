<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>設備詳細</title>
    <link rel="icon" type="image/png" href="./imgs/icons/ic-detail.svg" />
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <link rel="stylesheet" type="text/css" href="./fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
    <link rel="stylesheet" href="./vendor/bootstrap/bootstrap-4.0.0-dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./css/common.css">
    <link rel="stylesheet" type="text/css" href="./css/equipment_detail.css">
    <link rel="stylesheet" type="text/css" href="./css/modal.css">
    <link rel="stylesheet" type="text/css" href="./css/util.css">
    <link rel="stylesheet" href="./fonts/fontawesome-free-5.15.4-web/css/all.css">
</head>

<body>
    <div id="backgroundPage">
        <div class="container-mainform">
            <div class="dropdown select-role">
                <div class="btn-menu btn-secondary dropdown-toggle" type="button" id="dropdownSelectRole"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="text" id="userName"><i class="ic-dropdown far fa-user"></i><a id="name"></a></span>
                </div>
                <ul class="dropdown-menu" aria-labelledby="dropdownSelectRole">
                    <li>
                        <a class="dropdown-item scan-page" id="logoutOption">
                            <span class="text"><i class="ic-dropdown logout fas fa-sign-out-alt"></i>ログアウト</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="wrap-mainform">
                <span id="titleForm">
                    設備詳細
                </span>

                <p class="divider-text">
                    <span class="title-group" id="title"></span>
                </p>

                <div class="row content ed-v">
                    <div class="col-6">
                        <!-- <div class="row content"> -->
                        <div class="row content m-b-3 m-t-3">
                            <div class="col-12 ta-c" id="detail-img">
                                <img src="./imgs/mc-01.jpg">
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">年次点検
                                        </span>
                                    </div>

                                    <button type="button" class="btn btn-default text memo-btn">
                                        点検開始
                                    </button>
                                </div>
                            </div>
                        </div>
                        <!-- </div>     -->
                    </div>

                    <div class="col-6 m-t-5">
                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">前回点検日
                                        </span>
                                    </div>

                                    <input type="text" class="form-control ta-c text t-ip" id="lastCheck" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">次回点検日
                                        </span>
                                    </div>

                                    <input type="text" class="form-control ta-c text t-ip" id="nextCheck" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">管理番号</span>
                                    </div>

                                    <input type="text" class="form-control ta-l text t-ip" id="controlNumber"
                                        disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">メーカー</span>
                                    </div>

                                    <input type="text" class="form-control ta-l text t-ip" id="maker" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">購入日</span>
                                    </div>

                                    <input type="text" class="form-control ta-c text t-ip" id="purchaseDate" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">管理責任者</span>
                                    </div>

                                    <input type="text" class="form-control ta-l text t-ip" id="administrator"
                                        disabled />
                                </div>
                            </div>
                        </div>


                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw135 text jc-c">メモ</span>
                                    </div>
                                    <input type="button" class="btn memo-btn text t-ip" value="メモ追加" id="memoBtn">
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="row content ed-v m-t-20">
                    <div class="col-12">
                        <table class="table" id="memoTable">
                            <tr hidden>
                                <td class="col-2"></td>
                                <td class="col-9"></td>
                                <td class="col-1"></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="button-area p-b-10">
                    <div class="row ed-v">
                        <div class="col-3">
                            <button type="button" class="btn btn-default text-center" id="backBtn">戻る</button>
                        </div>
                        <div class="col-3">
                        </div>
                        <div class="col-3">
                        </div>
                        <div class="col-3">
                            <button type="button" class="btn btn-default text-center" id="setsubiShosaiBtn">登録</button>
                        </div>
                    </div>
                </div>

            </div>

            <!-- The Modal -->
            <div id="myModal" class="modal">
                <!-- Modal content -->
                <div class="modal-content">
                    <!-- Modal image area -->
                    <div class="modal-image-area background-error-modal">
                        <span class="modal-close-button">X</span>
                        <img id="imgStatusModal" class="modal-image">
                    </div>

                    <!-- Modal message area -->
                    <div class="modal-message">
                        <div class="modal-message-area">
                            <span class="title-modal text">題名</span>
                            <span class="modal-message-detail text">メッセージ</span>
                        </div>

                        <div id="buttonAreaModal">
                            <button class="button-modal btn-common button-0" role="button"></button>
                            <button class="button-modal btn-common button-1" role="button"></button>
                            <button class="button-modal btn-common button-2" role="button"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./fonts/fontawesome-free-5.15.4-web/js/fontawesome.min.js"></script>
    <script src="./vendor/jquery/jquery-3.2.1.min.js"></script>
    <script src="./vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script>
        /*****  VIEW VARIABLE  *****/
        const memoList = [
            ["2020年1月10日", "異音がしたため確認したが目立った…", ""],
            ["2021年11月22日", "ベアリング交換", ""],
        ];

        /**
   * MOVING TO ANOTHER PAGE
*/
        function movePage(page) {
            window.location.href = page;
        }

        /**
           * SET DATA ACTION
        */
        function setDataDetail() {
            document.getElementById("lastCheck").value = "2022年8月1日";
            document.getElementById("nextCheck").value = "2023年9月1日";
            document.getElementById("controlNumber").value = sessionStorage.getItem("equipmentName");
            document.getElementById("maker").value = "A社";
            document.getElementById("purchaseDate").value = "2019年7月1日";
            document.getElementById("administrator").value = "Nguyen Van Dung";
        }

        /**
           * GENERATE TABLE
        */
        function generateTable(listItem, tableName) {
            const table = document.getElementById(tableName);
            const tbody = document.createElement("tbody");
            table.appendChild(tbody);
            for (let i = 0; i < listItem.length; i++) {
                const row = document.createElement("tr");
                for (let j = 0; j < listItem[i].length; j++) {
                    const cell = document.createElement("td");
                    var button = document.createElement("button");
                    if (j != listItem[i].length - 1) {
                        var span = document.createElement("span");
                        span.textContent = listItem[i][j];
                        if (j == 0) {
                            cell.classList.add("col-2");
                        }
                        cell.appendChild(span);
                        cell.classList.add("text");
                        row.appendChild(cell);
                    }
                    else {
                        cell.classList.add("col-1");
                        button.id = i;
                        button.append("編集");
                        button.classList.add("btn");
                        button.classList.add("btn-default");
                        button.classList.add("detail-btn");
                        button.classList.add("text");
                        cell.appendChild(button);
                        row.appendChild(cell);
                    }
                }
                row.id = i;
                tbody.appendChild(row);
            }
        }

        /**
   * INITIALIZE MODAL
   *
   *
*/

        function setupModal(status, title, message, textButton0, textButton1, textButton2, isClose) {
            // init view
            var modal = document.getElementById("myModal");
            var imageModal = document.getElementsByClassName("modal-image")[0];
            var titleModal = document.getElementsByClassName("title-modal")[0];
            var messageModal = document.getElementsByClassName("modal-message-detail")[0];
            var button0 = document.getElementsByClassName("button-0")[0];
            var button1 = document.getElementsByClassName("button-1")[0];
            var button2 = document.getElementsByClassName("button-2")[0];
            var closeButton = document.getElementsByClassName("modal-close-button")[0];

            // title and message
            if (title != null) {
                titleModal.innerHTML = title;
            }
            if (message != null) {
                messageModal.innerHTML = message;
            }

            // status
            if (status == "load") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_loading_data.gif";
            } else if (status == "success") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_success.gif";
            } else if (status == "error") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_fail.gif";
            } else if (status == "question") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_question.gif";
            } else if (status == "info") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_info.gif";
            }

            // button
            if (textButton0 != null) {
                button0.style.display = "block";
                button0.innerHTML = textButton0;
                button0.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                button0.style.display = "none";
            }

            if (textButton1 != null) {
                button1.style.display = "block";
                button1.innerHTML = textButton1;
                button1.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                button1.style.display = "none";
            }

            if (textButton2 != null) {
                button2.style.display = "block";
                button2.innerHTML = textButton2;
                button2.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                button2.style.display = "none";
            }

            if (isClose == true) {
                closeButton.style.display = "block";
                closeButton.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                closeButton.style.display = "none";
            }

            modal.style.display = "block";
        }

        /**
           * ONCLICK ACTION
        */
        function onClickAction() {
            document.getElementById("logoutOption").onclick = function () {
                movePage('./login.html')
            }

            document.getElementById("backBtn").onclick = function () {
                movePage("./equipment_management_list.html")
            }

            document.getElementById("memoBtn").onclick = function () {
                sessionStorage.setItem("memoTitle", "");
                movePage("./memo.html")
            }

            document.getElementById("setsubiShosaiBtn").onclick = async function () {
                setupModal("success", null, "データ保存に成功しました。", null, "OK", null, false);
                document.getElementById("buttonAreaModal").onclick = function () {
                    movePage("./equipment_management_list.html");
                }
            }

            $('#memoTable').on('click', 'tbody tr td button', function () {
                sessionStorage.setItem("memoTitle", memoList[this.id][1]);
                movePage("./memo.html");
            })
        }

        /**
           * ONLOAD ACTION
        */
        function onLoadAction() {
            onClickAction();
            setDataDetail();
            generateTable(memoList, "memoTable")
            document.getElementById("title").innerHTML = sessionStorage.getItem("area") + "　＞　" + sessionStorage.getItem("item");
        }

        window.onload = onLoadAction;
    </script>
</body>

</html>