<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title id="title">設備詳細</title>
    <link rel="icon" type="image/png" href="./imgs/icons/ic-detail.svg" />
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <link rel="stylesheet" type="text/css" href="./fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
    <link rel="stylesheet" href="./vendor/bootstrap/bootstrap-4.0.0-dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./css/common.css">
    <link rel="stylesheet" type="text/css" href="./css/equipment_detail.css">
    <link rel="stylesheet" type="text/css" href="./css/modal.css">
    <link rel="stylesheet" type="text/css" href="./css/util.css">
    <link rel="stylesheet" href="./fonts/fontawesome-free-5.15.4-web/css/all.css">
</head>

<body>
    <div id="backgroundPage">
        <div class="container-mainform">
            <div class="dropdown select-role">
                <div class="btn-menu btn-secondary dropdown-toggle" type="button" id="dropdownSelectRole"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="text" id="userName"><i class="ic-dropdown far fa-user"></i><a id="name"></a></span>
                </div>
                <ul class="dropdown-menu" aria-labelledby="dropdownSelectRole">
                    <li>
                        <a class="dropdown-item scan-page" id="menuOption">
                            <span class="text" id="menuBtn"><i class="m-r-10 menu fas fa-bars"></i>メニュー</span>
                        </a>
                    </li>
                    <li>
                        <a class="dropdown-item scan-page" id="logoutOption">
                            <span class="text" id="logoutBtn"><i
                                    class="m-r-10 logout fas fa-sign-out-alt"></i>ログアウト</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="wrap-mainform">
                <span id="titleForm">
                    設備詳細
                </span>

                <p class="divider-text">
                    <span class="title-group" id="titleGroup"></span>
                </p>

                <div class="row content ed-v">
                    <div class="col-6">
                        <!-- <div class="row content"> -->
                        <div class="row content m-b-3 m-t-3">
                            <div class="col-12 ta-c" id="detail-img">
                                <img src="./imgs/mc-01.jpg">
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="yearlyCheck">年次点検
                                        </span>
                                    </div>

                                    <button type="button" class="btn btn-default text memo-btn" id="startCheck">
                                        点検開始
                                    </button>
                                </div>
                            </div>
                        </div>
                        <!-- </div>     -->
                    </div>

                    <div class="col-6 m-t-5">
                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="previousDate">前回点検日
                                        </span>
                                    </div>

                                    <input type="text" class="form-control ta-c text t-ip" id="lastCheck" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="nextDate">次回点検日
                                        </span>
                                    </div>

                                    <input type="text" class="form-control ta-c text t-ip" id="nextCheck" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="idNumber">管理番号</span>
                                    </div>

                                    <input type="text" class="form-control ta-l text t-ip" id="controlNumber"
                                        disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="makerCom">メーカー</span>
                                    </div>

                                    <input type="text" class="form-control ta-l text t-ip" id="maker" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="purchase">購入日</span>
                                    </div>

                                    <input type="text" class="form-control ta-c text t-ip" id="purchaseDate" disabled />
                                </div>
                            </div>
                        </div>

                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="supervisor">管理責任者</span>
                                    </div>

                                    <input type="text" class="form-control ta-l text t-ip" id="administrator"
                                        disabled />
                                </div>
                            </div>
                        </div>


                        <div class="row content ed-v">
                            <div class="col-12">
                                <div class="form-group input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text mw175 text jc-c" id="memo">メモ</span>
                                    </div>
                                    <input type="button" class="btn memo-btn text t-ip" value="メモ追加" id="memoBtn">
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="row content ed-v m-t-20">
                    <div class="col-12">
                        <table class="table" id="memoTable">
                            <tr hidden>
                                <td class="col-2"></td>
                                <td class="col-9"></td>
                                <td class="col-1"></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="button-area p-b-10">
                    <div class="row ed-v">
                        <div class="col-4">
                            <button type="button" class="btn btn-default text-center" id="backBtn">戻る</button>
                        </div>
                        <div class="col-4">
                        </div>
                        <div class="col-4">
                            <button type="button" class="btn btn-default text-center" id="setsubiShosaiBtn">登録</button>
                        </div>
                    </div>
                </div>

            </div>

            <!-- The Modal -->
            <div id="myModal" class="modal">
                <!-- Modal content -->
                <div class="modal-content">
                    <!-- Modal image area -->
                    <div class="modal-image-area background-error-modal">
                        <span class="modal-close-button">X</span>
                        <img id="imgStatusModal" class="modal-image">
                    </div>

                    <!-- Modal message area -->
                    <div class="modal-message">
                        <div class="modal-message-area">
                            <span class="title-modal text">題名</span>
                            <span class="modal-message-detail text">メッセージ</span>
                        </div>

                        <div id="buttonAreaModal">
                            <button class="button-modal btn-common button-0" role="button"></button>
                            <button class="button-modal btn-common button-1" role="button"></button>
                            <button class="button-modal btn-common button-2" role="button"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./fonts/fontawesome-free-5.15.4-web/js/fontawesome.min.js"></script>
    <script src="./vendor/jquery/jquery-3.2.1.min.js"></script>
    <script src="./vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script>
        /*****  VIEW VARIABLE  *****/
        const memoList = [
            [
                ["10/01/2020", "I checked it because there was an abnormal noise, but it was noticeable...", ""],
                ["22/11/2021", "Bearing replacement", ""],
            ],
            [
                ["10/01/2020", "Kiểm tra vì có tiếng ồn bất thường, nhưng nó rất đáng chú ý...", ""],
                ["22/11/2021", "Thay thế vòng bi", ""],
            ],
            [
                ["2020年1月10日", "異音がしたため確認したが目立った…", ""],
                ["2021年11月22日", "ベアリング交換", ""],
            ]
        ];
        var language = [
            [
                "FACILITY DETAILS",
                "Previous check date",
                "Next check date",
                "ID",
                "Maker",
                "Purchase date",
                "Supervisor",
                "Memo",
                "Add memo",
                "Yearly check",
                "Start check",
                "Back",
                "Register"
            ],
            [
                "CHI TIẾT THIẾT BỊ",
                "Ngày kiểm tra trước",
                "Ngày kiểm tra sau",
                "ID",
                "Công ty sản xuất",
                "Ngày mua",
                "Quản lý",
                "Ghi chú",
                "Thêm ghi chú",
                "Kiểm tra hằng năm",
                "Bắt đầu kiểm tra",
                "Trở về",
                "Đăng ký"
            ],
            [
                "設備詳細",
                "前回点検日",
                "次回点検日",
                "管理番号",
                "メーカー",
                "購入日",
                "管理責任者",
                "メモ",
                "メモ追加",
                "年次点検",
                "点検開始",
                "戻る",
                "登録"
            ]
        ];

        /**
           * SET LANGUAGE DATA
        */
        function setLanguage(lang) {
            document.getElementById("title").innerHTML = language[lang][0];
            document.getElementById("titleForm").innerHTML = language[lang][0];
            document.getElementById("previousDate").innerHTML = language[lang][1];
            document.getElementById("nextDate").innerHTML = language[lang][2];
            document.getElementById("idNumber").innerHTML = language[lang][3];
            document.getElementById("makerCom").innerHTML = language[lang][4];
            document.getElementById("purchase").innerHTML = language[lang][5];
            document.getElementById("supervisor").innerHTML = language[lang][6];
            document.getElementById("memo").innerHTML = language[lang][7];
            document.getElementById("memoBtn").value = language[lang][8];
            document.getElementById("yearlyCheck").innerHTML = language[lang][9];
            document.getElementById("startCheck").innerHTML = language[lang][10];
            document.getElementById("backBtn").innerHTML = language[lang][11];
            document.getElementById("setsubiShosaiBtn").innerHTML = language[lang][12];
        }

        /**
            * MOVING TO ANOTHER PAGE
        */
        function movePage(page) {
            window.location.href = page;
        }

        /**
           * SET DATA ACTION
        */
        function setDataDetail() {
            switch (parseInt(sessionStorage.getItem("language"))) {
                case 0:
                    document.getElementById("lastCheck").value = "01/08/2022";
                    document.getElementById("nextCheck").value = "01/09/2023";
                    document.getElementById("purchaseDate").value = "01/07/2019";
                    break;
                case 1:
                    document.getElementById("lastCheck").value = "01/08/2022";
                    document.getElementById("nextCheck").value = "01/09/2023";
                    document.getElementById("purchaseDate").value = "01/07/2019";
                    break;
                case 2:
                    document.getElementById("lastCheck").value = "2022年8月1日";
                    document.getElementById("nextCheck").value = "2023年9月1日";
                    document.getElementById("purchaseDate").value = "2019年7月1日";
                    break;
            }

            document.getElementById("controlNumber").value = sessionStorage.getItem("equipmentName");
            document.getElementById("maker").value = "A社";
            document.getElementById("administrator").value = "Nguyen Van Dung";
        }

        /**
           * GENERATE TABLE
        */
        function generateTable(listItem) {
            const table = document.getElementById("memoTable");
            const tbody = document.createElement("tbody");
            table.appendChild(tbody);
            for (let i = 0; i < listItem.length; i++) {
                const row = document.createElement("tr");
                for (let j = 0; j < listItem[i].length; j++) {
                    const cell = document.createElement("td");
                    var button = document.createElement("button");
                    if (j != listItem[i].length - 1) {
                        var span = document.createElement("span");
                        span.textContent = listItem[i][j];
                        if (j == 0) {
                            cell.classList.add("col-2");
                        }
                        cell.appendChild(span);
                        cell.classList.add("text");
                        row.appendChild(cell);
                    }
                    else {
                        cell.classList.add("col-1");
                        button.id = i;
                        switch (parseInt(sessionStorage.getItem("language"))) {
                            case 0:
                                button.append("Edit");
                                break;
                            case 1:
                                button.append("Sửa");
                                break;
                            case 2:
                                button.append("編集");
                                break;
                        }
                        button.classList.add("btn");
                        button.classList.add("btn-default");
                        button.classList.add("detail-btn");
                        button.classList.add("text");
                        cell.appendChild(button);
                        row.appendChild(cell);
                    }
                }
                row.id = i;
                tbody.appendChild(row);
            }
        }

        /**
            * INITIALIZE MODAL
        */
        function setupModal(status, title, message, textButton0, textButton1, textButton2, isClose) {
            // init view
            var modal = document.getElementById("myModal");
            var imageModal = document.getElementsByClassName("modal-image")[0];
            var titleModal = document.getElementsByClassName("title-modal")[0];
            var messageModal = document.getElementsByClassName("modal-message-detail")[0];
            var button0 = document.getElementsByClassName("button-0")[0];
            var button1 = document.getElementsByClassName("button-1")[0];
            var button2 = document.getElementsByClassName("button-2")[0];
            var closeButton = document.getElementsByClassName("modal-close-button")[0];

            // title and message
            if (title != null) {
                titleModal.innerHTML = title;
            }
            if (message != null) {
                messageModal.innerHTML = message;
            }

            // status
            if (status == "load") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_loading_data.gif";
            } else if (status == "success") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_success.gif";
            } else if (status == "error") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_fail.gif";
            } else if (status == "question") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_question.gif";
            } else if (status == "info") {
                titleModal.style.display = "none";
                imageModal.src = "./imgs/gif/gif_info.gif";
            }

            // button
            if (textButton0 != null) {
                button0.style.display = "block";
                button0.innerHTML = textButton0;
                button0.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                button0.style.display = "none";
            }

            if (textButton1 != null) {
                button1.style.display = "block";
                button1.innerHTML = textButton1;
                button1.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                button1.style.display = "none";
            }

            if (textButton2 != null) {
                button2.style.display = "block";
                button2.innerHTML = textButton2;
                button2.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                button2.style.display = "none";
            }

            if (isClose == true) {
                closeButton.style.display = "block";
                closeButton.onclick = function () {
                    modal.style.display = "none";
                }
            } else {
                closeButton.style.display = "none";
            }

            modal.style.display = "block";
        }

        /**
           * ONCLICK ACTION
        */
        function onClickAction() {
            document.getElementById("logoutOption").onclick = function () {
                movePage('./login.html')
            }

            document.getElementById("menuOption").onclick = function () {
                movePage('./menu.html')
            }

            document.getElementById("backBtn").onclick = function () {
                movePage("./equipment_management_list.html")
            }

            document.getElementById("memoBtn").onclick = function () {
                sessionStorage.setItem("memoTitle", "");
                movePage("./memo.html")
            }

            document.getElementById("setsubiShosaiBtn").onclick = function () {
                switch (parseInt(sessionStorage.getItem("language"))) {
                    case 0:
                        setupModal("success", null, "Data saved successfully.", null, "OK", null, false);
                        break;
                    case 1:
                        setupModal("success", null, "Dữ liệu đã lưu thành công.", null, "OK", null, false);
                        break;
                    case 2:
                        setupModal("success", null, "データ保存に成功しました。", null, "OK", null, false);
                        break;
                }
            }

            document.getElementById("buttonAreaModal").onclick = function () {
                movePage("./equipment_management_list.html");
            }

            $('#memoTable').on('click', 'tbody tr td button', function () {
                sessionStorage.setItem("memoTitle", memoList[parseInt(sessionStorage.getItem("language"))][this.id][1]);
                movePage("./memo.html");
            })
        }

        /**
           * ONLOAD ACTION
        */
        function onLoadAction() {
            onClickAction();
            setDataDetail();
            setLanguage(parseInt(sessionStorage.getItem("language")));
            generateTable(memoList[parseInt(sessionStorage.getItem("language"))]);
            switch (parseInt(sessionStorage.getItem("language"))) {
                case 0:
                    document.getElementById("menuBtn").innerHTML = '<i class="m-r-10 menu fas fa-bars"></i>Menu';
                    document.getElementById("logoutBtn").innerHTML = '<i class="m-r-10 logout fas fa-sign-out-alt"></i>Logout';
                    break;
                case 1:
                    document.getElementById("menuBtn").innerHTML = '<i class="m-r-10 menu fas fa-bars"></i>Menu';
                    document.getElementById("logoutBtn").innerHTML = '<i class="m-r-10 logout fas fa-sign-out-alt"></i>Đăng xuất';
                    break;
                case 2:
                    document.getElementById("menuBtn").innerHTML = '<i class="m-r-10 menu fas fa-bars"></i>メニュー';
                    document.getElementById("logoutBtn").innerHTML = '<i class="m-r-10 logout fas fa-sign-out-alt"></i>ログアウト';
                    break;
            }
            document.getElementById("titleGroup").innerHTML = sessionStorage.getItem("area") + "　＞　" + sessionStorage.getItem("item");
        }

        window.onload = onLoadAction;
    </script>
</body>

</html>